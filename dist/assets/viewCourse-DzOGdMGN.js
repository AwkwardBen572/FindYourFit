import{_ as z,u as P,r as i,a as T,c as N,o as j,b as r,d as v,e as u,t as l,g as m,f as h,h as B,i as p,j as x,k as O,s as R,l as E,m as c}from"./index-1hAoJFJ4.js";const L={class:"course_page"},V={key:0,class:"course_card"},A={class:"course_image_wrapper"},M={class:"course_theme_badge inter font_size_xs"},Y={class:"course_content"},q={class:"course_title licorice_regular"},F={key:0,class:"course_meta inter font_size_xs"},G={key:1,class:"course_summary inter font_size_xs"},H={key:2,class:"course_actions"},J=["disabled"],K={key:3,class:"inter font_size_xs course_actions"},Q={key:1,class:"course_loading inter font_size_xs"},W={__name:"viewCourse",setup(X){const C=T(),w=B(),k=P(),s=i(null),d=i(!1),y=i(!1),_=i(!1),g=i(!0),n=C.params.id;let o=null;const b=async()=>{const a=await m(h(x,"courses",n));if(!a.exists()){w.push({name:"Navigation"});return}if(s.value={id:a.id,...a.data()},p.currentUser){o=h(x,"users",p.currentUser.uid);const e=await m(o);e.exists()&&e.data().courses&&e.data().courses.find(D=>D.courseId===n)&&(_.value=!0)}g.value=!1},S=N(()=>s.value?.courseTheme?s.value.courseTheme.charAt(0).toUpperCase()+s.value.courseTheme.slice(1):""),U=async()=>{if(p.currentUser)try{d.value=!0;const a=new Date().toISOString().split("T")[0];o||(o=h(x,"users",p.currentUser.uid));const e=await m(o);let f=[];if(e.exists()&&(f=e.data().courses||[]),f.find(t=>t.courseId===n))await O(o,{courses:f.map(t=>t.courseId===n?{...t,lastDayCompleted:(t.lastDayCompleted||-1)+1,lastDayCompletedDate:a}:t)});else{await R(o,{courses:E({courseId:n,lastDayCompleted:-1,courseLength:s.value.numberOfDays,completed:!1})},{merge:!0});const t=await m(o);if(t.exists()){const I=t.data();k.setUserData(I)}w.push({name:"Courses"})}y.value=!0}catch(a){console.error(a)}finally{d.value=!1}};return j(b),(a,e)=>(c(),r("div",L,[s.value&&!g.value?(c(),r("div",V,[u("div",A,[u("div",M,l(S.value),1)]),u("div",Y,[u("div",q,l(s.value.name),1),_.value?v("",!0):(c(),r("div",F," ðŸ—“ "+l(s.value.numberOfDays)+" day journey ",1)),_.value?v("",!0):(c(),r("div",G,l(s.value.summary),1)),_.value?(c(),r("div",K,[...e[0]||(e[0]=[u("div",{class:"color_grey",style:{display:"flex","flex-flow":"row nowrap","justify-content":"center","align-items":"center"}},"You already own this course",-1)])])):(c(),r("div",H,[u("button",{class:"course_start_button inter font_size_xs",disabled:d.value||y.value,onClick:U},l(y.value?"Next day unlocks tomorrow":d.value?"Starting...":"Start Course"),9,J)]))])])):v("",!0),g.value?(c(),r("div",Q,[...e[1]||(e[1]=[u("div",{class:"spinner"},null,-1)])])):v("",!0)]))}},$=z(W,[["__scopeId","data-v-c8d7ee61"]]);export{$ as default};
